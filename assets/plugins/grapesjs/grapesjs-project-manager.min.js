/*! grapesjs-project-manager - 1.0.9 */
!function(e,t){'object'==typeof exports&&'object'==typeof module?module.exports=t():'function'==typeof define&&define.amd?define([],t):'object'==typeof exports?exports["grapesjs-project-manager"]=t():e["grapesjs-project-manager"]=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(e,'__esModule',{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&'object'==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,'default',{enumerable:!0,value:e}),2&t&&'string'!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e['default']}:function(){return e};return n.d(t,'a',t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=19)}([function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports["default"]=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports["default"]=e.exports,e.exports.__esModule=!0},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports["default"]=e.exports,e.exports.__esModule=!0,n(t)}e.exports=n,e.exports["default"]=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports["default"]=e.exports,e.exports.__esModule=!0},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e},e.exports["default"]=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(12);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)},e.exports["default"]=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(13)["default"],i=n(0);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?i(e):t},e.exports["default"]=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(18);e.exports=function(e,t){if(null==e)return{};var n,i,o=r(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o},e.exports["default"]=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e){throw new TypeError("\""+e+"\" is read-only")},e.exports["default"]=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(14),i=n(15),o=n(16),a=n(17);e.exports=function(e){return r(e)||i(e)||o(e)||a()},e.exports["default"]=e.exports,e.exports.__esModule=!0},function(e,t,n){!function(t){'use strict';var n=function(){return{escape:function(e){return e.replace(/([.*+?^${}()|\[\]\/\\])/g,'\\$1')},parseExtension:t,mimeType:function(e){var n=t(e).toLowerCase();return(r='application/font-woff',i='image/jpeg',{woff:r,woff2:r,ttf:'application/font-truetype',eot:'application/vnd.ms-fontobject',png:'image/png',jpg:i,jpeg:i,gif:'image/gif',tiff:'image/tiff',svg:'image/svg+xml'})[n]||'';var r,i},dataAsUrl:function(e,t){return'data:'+t+';base64,'+e},isDataUrl:function(e){return-1!==e.search(/^(data:)/)},canvasToBlob:function(e){return e.toBlob?new Promise((function(t){e.toBlob(t)})):function(e){return new Promise((function(t){for(var n=window.atob(e.toDataURL().split(',')[1]),r=n.length,i=new Uint8Array(r),o=0;o<r;o++)i[o]=n.charCodeAt(o);t(new Blob([i],{type:'image/png'}))}))}(e)},resolveUrl:function(e,t){var n=document.implementation.createHTMLDocument(),r=n.createElement('base');n.head.appendChild(r);var i=n.createElement('a');return n.body.appendChild(i),r.href=t,i.href=e,i.href},getAndEncode:function(e){var t=3e4;s.impl.options.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+(new Date).getTime());return new Promise((function(n){var r,i=new XMLHttpRequest;if(i.onreadystatechange=function(){if(4!==i.readyState)return;if(200!==i.status)return void(r?n(r):a('cannot fetch resource: '+e+', status: '+i.status));var t=new FileReader;t.onloadend=function(){var e=t.result.split(/,/)[1];n(e)},t.readAsDataURL(i.response)},i.ontimeout=function(){r?n(r):a('timeout of '+t+'ms occured while fetching resource: '+e)},i.responseType='blob',i.timeout=t,i.open('GET',e,!0),i.send(),s.impl.options.imagePlaceholder){var o=s.impl.options.imagePlaceholder.split(/,/);o&&o[1]&&(r=o[1])}function a(e){console.error(e),n('')}}))},uid:(e=0,function(){return'u'+('0000'+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)+e++}),delay:function(e){return function(t){return new Promise((function(n){setTimeout((function(){n(t)}),e)}))}},asArray:function(e){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t},escapeXhtml:function(e){return e.replace(/#/g,'%23').replace(/\n/g,'%0A')},makeImage:function(e){return new Promise((function(t,n){var r=new Image;r.onload=function(){t(r)},r.onerror=n,r.src=e}))},width:function(e){var t=n(e,'border-left-width'),r=n(e,'border-right-width');return e.scrollWidth+t+r},height:function(e){var t=n(e,'border-top-width'),r=n(e,'border-bottom-width');return e.scrollHeight+t+r}};var e;function t(e){var t=/\.([^\.\/]*?)$/g.exec(e);return t?t[1]:''}function n(e,t){var n=window.getComputedStyle(e).getPropertyValue(t);return parseFloat(n.replace('px',''))}}(),r=function(){var e=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:function(e,n,o){return function(){return!t(e)}()?Promise.resolve(e):Promise.resolve(e).then(r).then((function(t){var r=Promise.resolve(e);return t.forEach((function(e){r=r.then((function(t){return i(t,e,n,o)}))})),r}))},shouldProcess:t,impl:{readUrls:r,inline:i}};function t(t){return-1!==t.search(e)}function r(t){for(var r,i=[];null!==(r=e.exec(t));)i.push(r[1]);return i.filter((function(e){return!n.isDataUrl(e)}))}function i(e,t,r,i){return Promise.resolve(t).then((function(e){return r?n.resolveUrl(e,r):e})).then(i||n.getAndEncode).then((function(e){return n.dataAsUrl(e,n.mimeType(t))})).then((function(r){return e.replace(function(e){return new RegExp('(url\\([\'"]?)('+n.escape(e)+')([\'"]?\\))','g')}(t),'$1'+r+'$3')}))}}(),i=function(){return{resolveAll:function(){return e(document).then((function(e){return Promise.all(e.map((function(e){return e.resolve()})))})).then((function(e){return e.join('\n')}))},impl:{readAll:e}};function e(){return Promise.resolve(n.asArray(document.styleSheets)).then((function(e){var t=[];return e.forEach((function(e){try{n.asArray(e.cssRules||[]).forEach(t.push.bind(t))}catch(t){console.log('Error while reading CSS rules from '+e.href,t.toString())}})),t})).then((function(e){return e.filter((function(e){return e.type===CSSRule.FONT_FACE_RULE})).filter((function(e){return r.shouldProcess(e.style.getPropertyValue('src'))}))})).then((function(t){return t.map(e)}));function e(e){return{resolve:function(){var t=(e.parentStyleSheet||{}).href;return r.inlineAll(e.cssText,t)},src:function(){return e.style.getPropertyValue('src')}}}}}(),o=function(){return{inlineAll:function t(i){return i instanceof Element?function(e){var t=e.style.getPropertyValue('background');return t?r.inlineAll(t).then((function(t){e.style.setProperty('background',t,e.style.getPropertyPriority('background'))})).then((function(){return e})):Promise.resolve(e)}(i).then((function(){return i instanceof HTMLImageElement?e(i).inline():Promise.all(n.asArray(i.childNodes).map((function(e){return t(e)})))})):Promise.resolve(i)},impl:{newImage:e}};function e(e){return{inline:function(t){return n.isDataUrl(e.src)?Promise.resolve():Promise.resolve(e.src).then(t||n.getAndEncode).then((function(t){return n.dataAsUrl(t,n.mimeType(e.src))})).then((function(t){return new Promise((function(n,r){e.onload=n,e.onerror=r,e.src=t}))}))}}}}(),a={imagePlaceholder:void 0,cacheBust:!1},s={toSvg:c,toPng:function(e,t){return u(e,t||{}).then((function(e){return e.toDataURL()}))},toJpeg:function(e,t){return u(e,t=t||{}).then((function(e){return e.toDataURL('image/jpeg',t.quality||1)}))},toBlob:function(e,t){return u(e,t||{}).then(n.canvasToBlob)},toPixelData:function(e,t){return u(e,t||{}).then((function(t){return t.getContext('2d').getImageData(0,0,n.width(e),n.height(e)).data}))},impl:{fontFaces:i,images:o,util:n,inliner:r,options:{}}};function c(e,t){return function(e){void 0===e.imagePlaceholder?s.impl.options.imagePlaceholder=a.imagePlaceholder:s.impl.options.imagePlaceholder=e.imagePlaceholder;void 0===e.cacheBust?s.impl.options.cacheBust=a.cacheBust:s.impl.options.cacheBust=e.cacheBust}(t=t||{}),Promise.resolve(e).then((function(e){return function e(t,r,i){return i||!r||r(t)?Promise.resolve(t).then((function(e){return e instanceof HTMLCanvasElement?n.makeImage(e.toDataURL()):e.cloneNode(!1)})).then((function(e){return o(t,e,r)})).then((function(e){return function(e,t){return t instanceof Element?Promise.resolve().then(r).then(i).then(o).then(a).then((function(){return t})):t;function r(){var r,i;r=window.getComputedStyle(e),i=t.style,r.cssText?i.cssText=r.cssText:function(e,t){n.asArray(e).forEach((function(n){t.setProperty(n,e.getPropertyValue(n),e.getPropertyPriority(n))}))}(r,i)}function i(){[':before',':after'].forEach((function(r){!function(r){var i=window.getComputedStyle(e,r),o=i.getPropertyValue('content');if(''===o||'none'===o)return;var a=n.uid();t.className=t.className+' '+a;var s=document.createElement('style');s.appendChild(function(e,t,r){var i='.'+e+':'+t,o=r.cssText?function(e){var t=e.getPropertyValue('content');return e.cssText+' content: '+t+';'}(r):function(e){return n.asArray(e).map((function(t){return t+': '+e.getPropertyValue(t)+(e.getPropertyPriority(t)?' !important':'')})).join('; ')+';'}(r);return document.createTextNode(i+'{'+o+'}')}(a,r,i)),t.appendChild(s)}(r)}))}function o(){e instanceof HTMLTextAreaElement&&(t.innerHTML=e.value),e instanceof HTMLInputElement&&t.setAttribute("value",e.value)}function a(){t instanceof SVGElement&&(t.setAttribute('xmlns','http://www.w3.org/2000/svg'),t instanceof SVGRectElement&&['width','height'].forEach((function(e){var n=t.getAttribute(e);n&&t.style.setProperty(e,n)})))}}(t,e)})):Promise.resolve();function o(t,r,i){var o=t.childNodes;return 0===o.length?Promise.resolve(r):a(r,n.asArray(o),i).then((function(){return r}));function a(t,n,r){var i=Promise.resolve();return n.forEach((function(n){i=i.then((function(){return e(n,r)})).then((function(e){e&&t.appendChild(e)}))})),i}}}(e,t.filter,!0)})).then(l).then(d).then((function(e){t.bgcolor&&(e.style.backgroundColor=t.bgcolor);t.width&&(e.style.width=t.width+'px');t.height&&(e.style.height=t.height+'px');t.style&&Object.keys(t.style).forEach((function(n){e.style[n]=t.style[n]}));return e})).then((function(r){return function(e,t,r){return Promise.resolve(e).then((function(e){return e.setAttribute('xmlns','http://www.w3.org/1999/xhtml'),(new XMLSerializer).serializeToString(e)})).then(n.escapeXhtml).then((function(e){return'<foreignObject x="0" y="0" width="100%" height="100%">'+e+'</foreignObject>'})).then((function(e){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+t+'" height="'+r+'">'+e+'</svg>'})).then((function(e){return'data:image/svg+xml;charset=utf-8,'+e}))}(r,t.width||n.width(e),t.height||n.height(e))}))}function u(e,t){return c(e,t).then(n.makeImage).then(n.delay(100)).then((function(r){var i=function(e){var r=document.createElement('canvas');if(r.width=t.width||n.width(e),r.height=t.height||n.height(e),t.bgcolor){var i=r.getContext('2d');i.fillStyle=t.bgcolor,i.fillRect(0,0,r.width,r.height)}return r}(e);return i.getContext('2d').drawImage(r,0,0),i}))}function l(e){return i.resolveAll().then((function(t){var n=document.createElement('style');return e.appendChild(n),n.appendChild(document.createTextNode(t)),e}))}function d(e){return o.inlineAll(e).then((function(){return e}))}1&&(e.exports=s)}()},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports["default"]=e.exports,e.exports.__esModule=!0},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports["default"]=e.exports,e.exports.__esModule=!0,n(t,r)}e.exports=n,e.exports["default"]=e.exports,e.exports.__esModule=!0},function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?(e.exports=n=function(e){return typeof e},e.exports["default"]=e.exports,e.exports.__esModule=!0):(e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports["default"]=e.exports,e.exports.__esModule=!0),n(t)}e.exports=n,e.exports["default"]=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(11);e.exports=function(e){if(Array.isArray(e))return r(e)},e.exports["default"]=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)},e.exports["default"]=e.exports,e.exports.__esModule=!0},function(e,t,n){var r=n(11);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports["default"]=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports["default"]=e.exports,e.exports.__esModule=!0},function(e,t){e.exports=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i},e.exports["default"]=e.exports,e.exports.__esModule=!0},function(e,t,n){"use strict";n.r(t);var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(4),c=n.n(s),u=n(0),l=n.n(u),d=n(5),f=n.n(d),p=n(6),h=n.n(p),m=n(2),v=n.n(m),g=n(8),b=n.n(g);function y(e,t){var n,r={second:1e3,minute:60*1e3,hour:60*1e3*60,day:24*60*1e3*60,week:7*24*60*1e3*60,month:30*24*60*1e3*60,year:365*24*60*1e3*60},i=Math.round,o=' ago',a=function(e,n){return void 0===t?"".concat(n," ").concat(e+(n>1?'s':'')+o):n+e.substring(0,1)},s=Date.now()-new Date(e).getTime();for(var c in s<0&&(s*=(b()("ts"),-1),b()("dir"),o=' from now'),r){if(i(s)<(0)[c])return a(n||'m',i(s/(r[n]||1)));n=c}return a(c,i(s/r[c]))}function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a()(this,e),this.editor=t,this.$=t.$,this.pfx=t.getConfig('stylePrefix'),this.id=t.Storage.getConfig().id||'gjs-',this.opts=n,this.setState=this.setState.bind(this),this.setStateSilent=this.setStateSilent.bind(this),this.onRender=this.onRender.bind(this),this.handleTabs=this.handleTabs.bind(this)}return c()(e,[{key:"setState",value:function(e){this.state=w(w({},this.state),e),this.update()}},{key:"setStateSilent",value:function(e){this.state=w(w({},this.state),e)}},{key:"sm",get:function(){return this.editor.Storage}},{key:"cs",get:function(){return this.editor.Storage.getCurrentStorage()}},{key:"pm",get:function(){return this.editor.Pages}},{key:"onRender",value:function(){}},{key:"handleTabs",value:function(){}}]),e}();function O(e,t){return!(!t||!e)&&t.toLowerCase().indexOf(e.toLowerCase())>-1}function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var k=function(e){f()(n,e);var t=T(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a()(this,n),(r=t.call(this,e,i)).handleSort=r.handleSort.bind(l()(r)),r.handleFilterInput=r.handleFilterInput.bind(l()(r)),r.handleNameInput=r.handleNameInput.bind(l()(r)),r.handleOpen=r.handleOpen.bind(l()(r)),r.handleCreate=r.handleCreate.bind(l()(r)),r.handleDelete=r.handleDelete.bind(l()(r)),r.openEdit=r.openEdit.bind(l()(r)),r.state={editableProjectId:'',projectId:'',tab:'pages',sites:[],nameText:'',filterText:'',loading:!1,sortBy:'published_at',sortOrder:'desc'},r}return c()(n,[{key:"editableId",get:function(){return this.state.editableProjectId}},{key:"allSites",get:function(){return this.state.sites}},{key:"onRender",value:function(){var e=this.setState,t=this.cs;e({loading:!0}),t.loadAll((function(t){e({sites:t,loading:!1})}),(function(e){return console.log("Error",e)}))}},{key:"handleFilterInput",value:function(e){this.setState({filterText:e.target.value.trim()})}},{key:"handleNameInput",value:function(e){this.setStateSilent({nameText:e.target.value.trim()})}},{key:"handleSort",value:function(e){var t=this.state.sortOrder;e.target&&e.target.dataset&&this.setState({sortBy:e.target.dataset.sort,sortOrder:'desc'===t?'asc':'desc'})}},{key:"handleTabs",value:function(e){var t=e.target,n=this.$el,r=this.pfx,i=this.$;n.find(".".concat(r,"tablinks")).removeClass('active'),i(t).addClass('active'),'pages'===t.id?this.setState({tab:'pages'}):this.setState({tab:'templates'})}},{key:"handleOpen",value:function(e){var t=this.editor,n=this.cs,r=this.state.projectId;r&&r!==n.currentId&&(n.setId(r),t.load((function(e){n.setName(e.name),n.setThumbnail(e.thumbnail||''),n.setIsTemplate(e.template),n.setDescription(e.description||'No description'),t.Modal.close()})))}},{key:"handleCreate",value:function(e){var t=this.editor,n=this.cs,r=this.state,i=r.projectId,o=r.nameText,a=t.runCommand('get-uuidv4'),s=o||'New-'+a.substr(0,8);i?(n.setId(i),n.setIsTemplate(!1),t.load((function(e){n.setId(a),n.setName(s),n.setThumbnail(e.thumbnail||''),n.setDescription(e.description||'No description'),t.Modal.close()}))):n.store({id:a,name:s,template:!1,thumbnail:'',styles:'',description:'No description',pages:[{name:'index',component:''}]},(function(e){n.setId(a),n.setIsTemplate(!1),t.load((function(e){n.setId(e.id),n.setName(e.name),n.setThumbnail(e.thumbnail||''),n.setDescription(e.description||'No description'),t.Modal.close()}))}))}},{key:"openEdit",value:function(e){var t=this.editor;(0,this.setStateSilent)({editableProjectId:e.currentTarget.dataset.id}),t.Modal.close(),t.SettingsApp.setTab('project'),t.runCommand('open-settings')}},{key:"handleEdit",value:function(e){this.cs.update(S(S({},e),{},{updated_at:Date()}))}},{key:"handleDelete",value:function(e){var t=this.cs,n=this.setState,r=this.opts;t.delete((function(e){r.onDelete(e),t.loadAll((function(e){return n({sites:e})}),(function(e){return console.log("Error",e)}))}),r.onDeleteError,e.currentTarget.dataset.id)}},{key:"renderSiteList",value:function(){var e,t=this,n=this.state,r=n.sites,i=n.tab,o=n.filterText,a=n.loading,s=n.sortBy,c=n.sortOrder,u=this.pfx,l=this.opts,d=this.cs;if(a)return l.loader||'<div>Loading sites...</div>';if(!r.length)return l.nosites||'<div>No Sites</div>';'id'===s?e=function(e,t){return function(n,r){if('asc'===t){if(n[e]<r[e])return-1;if(n[e]>r[e])return 1}return n[e]>r[e]?-1:n[e]<r[e]?1:0}}(s,c):'updated_at'!==s&&'created_at'!==s||(e=function(e,t){return function(n,r){var i=new Date(n[e]).getTime(),o=new Date(r[e]).getTime();return'asc'===t?i-o:o-i}}(s,c));var f=r.sort(e).filter((function(e){if(!o&&'pages'===i)return!0;var t=e.id,n=e.name,r=e.template;return!(!O(o,t)&&!O(o,n)||'pages'!==i)||!('templates'!==i||!r)})).map((function(e,n){var r=e.id,i=e.name,o=e.description,a=e.thumbnail,s=e.created_at,c=e.updated_at,l=JSON.parse(e["".concat(t.id,"pages")]),f=c?y(new Date(c).getTime()):'NA',p=s?y(new Date(s).getTime()):'NA',h=l.map((function(e){return e.name})).join(', ');return"<div class=\"site-wrapper ".concat(d.currentId===r?'open':'',"\" key=\"").concat(n,"\" data-id=\"").concat(r,"\" title=\"Select to open site\">\n                        <div class=\"site-screenshot\">\n                            <img src=\"").concat(a,"\" alt=\"\" />\n                        </div>\n                        <div class=\"site-info\">\n                            <h2>\n                                ").concat(i,"\n                            </h2>\n                            <div class=\"site-meta\">\n                                ").concat(o,"\n                            </div>\n                        </div>\n                        <div class=\"site-update-time\">").concat(f,"</div>\n                        <div class=\"site-pages\">\n                            <div title=\"").concat(h||r,"\">\n                                ").concat(l.length||1,"\n                            </div>\n                        </div>\n                        <div class=\"site-create-time\">").concat(p,"</div>\n                        <div class=\"site-actions\">\n                            <i class=\"").concat(u,"caret-icon fa fa-hand-pointer-o edit\" title=\"edit\" data-id=\"").concat(r,"\"></i>\n                            ").concat(d.currentId!==r?"<i class=\"".concat(u,"caret-icon fa fa-trash-o delete\" title=\"delete\" data-id=\"").concat(r,"\"></i>"):'',"\n                        </div>\n                    </div>")})).join('\n');if(!f.length){if('templates'===i)return l.nosites||'<div>No Templates Available.</div>';f="<div>\n                    <h3>\n                        No '".concat(o,"' examples found. Clear your search and try again.\n                    </h3>\n                </div>")}return f}},{key:"renderSiteActions",value:function(){return'pages'===this.state.tab?"<div  class=\"flex-row\"><input class=\"search tm-input\" placeholder=\"Search for sites by name or id\"/>\n            <button id=\"open\" class=\"primary-button\">Open</button></div>":"<div class=\"".concat(this.pfx,"tip-about ").concat(this.pfx,"four-color\">").concat(this.opts.help,"</div>\n            <div  class=\"flex-row\"><input class=\"name tm-input\" placeholder=\"Enter new page name\"/>\n            <button id=\"create\" class=\"primary-button\">Create</button></div>")}},{key:"renderThumbnail",value:function(e,t){var n="<img src=\"".concat(e,"\" alt=\"\" />");return e?n:t.html?"<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"template-preview\" viewBox=\"0 0 1300 1100\" width=\"99%\" height=\"220\">\n                <foreignObject width=\"100%\" height=\"100%\" style=\"pointer-events:none\">\n                    <div xmlns=\"http://www.w3.org/1999/xhtml\">\n                        ".concat(t.html+'<style scoped>'+t.css+'</style>',"\n                    </div>\n                </foreignObject>\n            </svg>"):n}},{key:"update",value:function(){var e,t,n,r,i,o,a,s,c,u=this;null===(e=this.$el)||void 0===e||e.find('#site-list').html(this.renderSiteList()),null===(t=this.$el)||void 0===t||t.find('#tm-actions').html(this.renderSiteActions());var l=null===(n=this.$el)||void 0===n?void 0:n.find('.site-wrapper'),d=null===(r=this.$el)||void 0===r?void 0:r.find('input.search'),f=null===(i=this.$el)||void 0===i?void 0:i.find('input.name');this.setStateSilent({projectId:''}),l&&l.on('click',(function(e){l.removeClass('selected'),u.$(e.currentTarget).addClass('selected'),u.setStateSilent({projectId:e.currentTarget.dataset.id})})),d&&(d.val(this.state.filterText),d.on('change',this.handleFilterInput)),f&&(f.val(this.state.nameText),f.on('change',this.handleNameInput)),null===(o=this.$el)||void 0===o||o.find('#open').on('click',this.handleOpen),null===(a=this.$el)||void 0===a||a.find('#create').on('click',this.handleCreate),null===(s=this.$el)||void 0===s||s.find('i.edit').on('click',this.openEdit),null===(c=this.$el)||void 0===c||c.find('i.delete').on('click',this.handleDelete)}},{key:"render",value:function(){var e,t=this.$,n=this.pfx,r=this.opts,i=this.state.tab;this.onRender(),null===(e=this.$el)||void 0===e||e.remove();var o=t("<div class=\"app\">\n                <div class=\"contents\">\n                    <div class=\"".concat(n,"tab\">\n                        <button id=\"pages\" class=\"").concat(n,"tablinks ").concat('pages'===i?'active':'',"\">").concat(r.tabsText.pages,"</button>\n                        <button id=\"templates\" class=\"").concat(n,"tablinks ").concat('templates'===i?'active':'',"\"\">").concat(r.tabsText.templates,"</button>\n                    </div>\n                    <div id=\"tm-actions\">\n                        ").concat(this.renderSiteActions(),"\n                    </div>\n                    <div class=\"site-wrapper-header\">\n                        <div\n                            class=\"site-screenshot-header header\"\n                            data-sort=\"id\"\n                            title=\"Click to sort by site name\"\n                        >\n                            Site Info\n                        </div>\n                        <div\n                            class=\"site-info header\"\n                            data-sort=\"id\"\n                        ></div>\n                        <div\n                            class=\"site-update-time header\"\n                            data-sort=\"updated_at\"\n                            title=\"Click to sort by last update date\"\n                        >\n                            Last updated\n                        </div>\n                        <div\n                            class=\"site-pages header\"\n                            data-sort=\"pages\"\n                            title=\"Click to sort by number of pages\"\n                        >\n                            Pages\n                        </div>\n                        <div\n                            class=\"site-create-time header\"\n                            data-sort=\"created_at\"\n                            title=\"Click to sort by site creation date\"\n                        >\n                            Created At\n                        </div>\n                        <div\n                            class=\"site-actions header\"\n                            data-sort=\"id\"\n                            title=\"Click to sort by site name\"\n                        >\n                            Actions\n                        </div>\n                    </div>\n                    <div id=\"site-list\">\n                        ").concat(this.renderSiteList(),"\n                    </div>\n                </div>\n            </div>"));return o.find('.header').on('click',this.handleSort),o.find('#pages, #templates').on('click',this.handleTabs),this.$el=o,o}}]),n}(P),I=n(9),D=n.n(I);function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var _=function(e){f()(n,e);var t=E(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a()(this,n),(r=t.call(this,e,i)).addPage=r.addPage.bind(l()(r)),r.selectPage=r.selectPage.bind(l()(r)),r.removePage=r.removePage.bind(l()(r)),r.isSelected=r.isSelected.bind(l()(r)),r.handleNameInput=r.handleNameInput.bind(l()(r)),r.openEdit=r.openEdit.bind(l()(r)),r.state={editablePageId:'',isShowing:!0,nameText:'',pages:[],loading:!1},r}return c()(n,[{key:"editableId",get:function(){return this.state.editablePageId}},{key:"onRender",value:function(){var e=this.pm,t=this.setState,n=this.editor;t({loading:!0}),t({pages:D()(e.getAll())}),n.on('page',(function(){t({pages:D()(e.getAll())})})),t({loading:!1})}},{key:"isSelected",value:function(e){return this.pm.getSelected().id===e.id}},{key:"selectPage",value:function(e){this.pm.select(e.currentTarget.dataset.key),this.update()}},{key:"removePage",value:function(e){this.pm.remove(e.currentTarget.dataset.key),this.update()}},{key:"openEdit",value:function(e){var t=this.editor;this.setStateSilent({editablePageId:e.currentTarget.dataset.key}),t.Modal.close(),t.SettingsApp.setTab('page'),t.runCommand('open-settings')}},{key:"editPage",value:function(e,t){var n=this.pm.get(e);null==n||n.set('name',t),this.update()}},{key:"addPage",value:function(){var e=this.pm,t=this.state.nameText;t&&(e.add({name:t,component:''}),this.update())}},{key:"handleNameInput",value:function(e){this.setStateSilent({nameText:e.target.value.trim()})}},{key:"renderPagesList",value:function(){var e=this.state,t=e.pages,n=e.loading,r=this.opts,i=this.isSelected;return n?r.loader||'<div>Loading pages...</div>':t.map((function(e,t){return"<div \n                data-id=\"".concat(t,"\" \n                data-key=\"").concat(e.id,"\"  \n                class=\"page ").concat(i(e)?'selected':'',"\"\n            >\n                <i class=\"fa fa-file-o\" style=\"margin:5px;\"></i>\n                ").concat(e.get('name')||e.id,"\n                ").concat(i(e)?'':"<span class=\"page-close\" data-key=\"".concat(e.id,"\">&Cross;</span>"),"\n                <span class=\"page-edit\" data-key=\"").concat(e.id,"\"><i class=\"fa fa-hand-pointer-o\"></i></span>\n            </div>")})).join("\n")}},{key:"update",value:function(){var e,t,n,r;null===(e=this.$el)||void 0===e||e.find('.pages').html(this.renderPagesList()),null===(t=this.$el)||void 0===t||t.find('.page').on('click',this.selectPage),null===(n=this.$el)||void 0===n||n.find('.page-edit').on('click',this.openEdit),null===(r=this.$el)||void 0===r||r.find('.page-close').on('click',this.removePage)}},{key:"render",value:function(){var e,t=this.$;this.onRender(),null===(e=this.$el)||void 0===e||e.remove();var n=t("<div style=\"display: ".concat(this.state.isShowing?'flex':'none',";\" class=\"pages-wrp\">\n                <div class=\"pages\">\n                    ").concat(this.renderPagesList(),"\n                </div>\n                <div  class=\"flex-row\">\n                    <input class=\"tm-input sm\" type=\"text\" placeholder=\"page name\" />\n                </div>\n                <div class=\"add-page\">New Page +</div>\n            </div>"));return n.find('.add-page').on('click',this.addPage),n.find('input').on('change',this.handleNameInput),this.$el=n,n}},{key:"findPanel",get:function(){return this.editor.Panels.getPanel('views-container')}},{key:"showPanel",value:function(){var e;this.state.isShowing=!0,null===(e=this.findPanel)||void 0===e||e.set('appendContent',this.render()).trigger('change:appendContent'),this.update()}},{key:"hidePanel",value:function(){this.state.isShowing=!1,this.render()}}]),n}(P);function A(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=v()(e);if(t){var i=v()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h()(this,n)}}var C=function(e){f()(n,e);var t=A(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return a()(this,n),(r=t.call(this,e,i)).handleSave=r.handleSave.bind(l()(r)),r.handleThumbnail=r.handleThumbnail.bind(l()(r)),r.handleThumbnailInput=r.handleThumbnailInput.bind(l()(r)),r.state={tab:'page',loading:!1},r}return c()(n,[{key:"setTab",value:function(e){this.state.tab=e}},{key:"update",value:function(){var e=this.$el;null==e||e.find('#settings').html(this.renderSettings()),null==e||e.find('#generate').on('click',this.handleThumbnail),null==e||e.find('input#thumbnail').on('change',this.handleThumbnailInput)}},{key:"onRender",value:function(){var e=this.setState;e({loading:!0}),e({loading:!1})}},{key:"handleSave",value:function(e){var t=this.$el,n=this.editor;if('page'===this.state.tab){var r=n.PagesApp.editableId,i=null==t?void 0:t.find('input.name').val().trim();r&&n.PagesApp.editPage(r,i)}else{var o=n.TemplateManager.editableId,a=null==t?void 0:t.find('input.thumbnail').val().trim(),s=null==t?void 0:t.find('input.name').val().trim(),c=null==t?void 0:t.find('input.desc').val().trim(),u=null==t?void 0:t.find('input.template').get(0).checked;o&&n.TemplateManager.handleEdit({id:o,thumbnail:a,name:s,description:c,template:u})}n.Modal.close()}},{key:"handleThumbnail",value:function(e){var t=this.editor,n=this.$el;t.runCommand('take-screenshot',{clb:function(e){null==n||n.find('input.thumbnail').val(e),null==n||n.find('img').attr('src',e)}})}},{key:"handleThumbnailInput",value:function(e){var t;null===(t=this.$el)||void 0===t||t.find('img').attr('src',e.target.value.trim())}},{key:"renderSettings",value:function(){var e=this.state,t=e.tab,n=e.loading,r=this.opts,i=this.pfx,o=this.pm,a=this.editor;if(n)return r.loader||'<div>Loading settings...</div>';if('page'===t){var s=o.get(a.PagesApp.editableId),c=(null==s?void 0:s.get('name'))||(null==s?void 0:s.id)||'';return"<label for=\"name\">Name</label>\n                <div class=\"flex-row\">\n                    <input class=\"name tm-input\" value=\"".concat(c,"\" placeholder=\"Current page name\"/>\n                </div>")}var u=a.TemplateManager.allSites.find((function(e){return e.id===a.TemplateManager.editableId}));return"<div class=\"".concat(i,"tip-about ").concat(i,"four-color\">Enter url, or generate thumbnail.</div>\n                <label for=\"thumbnail\">Thumbnail</label>\n                <div class=\"flex-row\">\n                    <input id=\"thumbnail\" class=\"thumbnail tm-input\" value=\"").concat((null==u?void 0:u.thumbnail)||'',"\" placeholder=\"Project thumbnail\"/>\n                </div>\n                <div class=\"flex-row\" style=\"margin-bottom:15px;\">\n                    <div class=\"site-screenshot\">\n                        <img src=\"").concat((null==u?void 0:u.thumbnail)||'',"\" alt=\"screenshot\" />\n                    </div>\n                    <button id=\"generate\" class=\"primary-button\">Generate</button>\n                </div>\n                <label for=\"name\">Name</label>\n                <div class=\"flex-row\">\n                    <input id=\"name\" class=\"name tm-input\" value=\"").concat((null==u?void 0:u.name)||'',"\" placeholder=\"Project name\"/>\n                </div>\n                <label for=\"desc\">Description</label>\n                <div class=\"flex-row\">\n                    <input id=\"desc\" class=\"desc tm-input\" value=\"").concat((null==u?void 0:u.description)||'',"\" placeholder=\"Project description\"/>\n                </div>\n                <div class=\"flex-row group\">\n                    <input id=\"template\" class=\"template\" type=\"checkbox\" ").concat(null!=u&&u.template?'checked':'',"/>\n                    <label for=\"template\">Template</label>\n                </div>")}},{key:"render",value:function(){var e,t=this.$;this.onRender(),null===(e=this.$el)||void 0===e||e.remove();var n=t("<div class=\"app\">\n                <div id=\"settings\">\n                    ".concat(this.renderSettings(),"\n                </div>\n                <div class=\"flex-row\">\n                    <button id=\"save\" class=\"primary-button\">Save</button>\n                </div>\n            </div>"));return n.find('#save').on('click',this.handleSave),n.find('#generate').on('click',this.handleThumbnail),n.find('input#thumbnail').on('change',this.handleThumbnailInput),this.$el=n,n}}]),n}(P),M=k,N=n(10),R=n.n(N);function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var B=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.Commands,r=e.Storage.getCurrentStorage(),i=e.Modal,o=e.getConfig('stylePrefix'),a="".concat(o,"mdl-dialog-tml"),s="".concat(o,"mdl-dialog-md");e.domtoimage=R.a,n.add('open-templates',{run:function(e,n){var r=document.querySelector(".".concat(o,"mdl-dialog"));r.classList.add(a),(null==n?void 0:n.set)&&n.set('active'),i.setTitle(t.mdlTitle),i.setContent(e.TemplateManager.render()),i.open(),i.getModel().once('change:open',(function(){r.classList.remove(a)}))}}),n.add('open-settings',{run:function(e,n){var r=document.querySelector(".".concat(o,"mdl-dialog"));r.classList.add(s),(null==n?void 0:n.set)&&n.set('active'),i.setTitle(t.mdlTitle),i.setContent(e.SettingsApp.render()),i.open(),i.getModel().once('change:open',(function(){r.classList.remove(s)}))}}),n.add('open-pages',{run:function(e){e.PagesApp.showPanel()},stop:function(e){e.PagesApp.hidePanel()}});var c=function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))},u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;R.a.toJpeg(e,t).then((function(e){return n&&n(e)})).catch((function(e){return r&&r(e)}))};n.add('get-uuidv4',(function(){return c()})),n.add('take-screenshot',(function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clb:function(e){return e}},i=e.getWrapper().getEl();u(i,{quality:t.quality,height:1e3,cacheBust:!0,style:$({'background-color':'white'},e.getWrapper().getStyle())},r.clb,t.onScreenshotError)})),n.add('save-as-template',(function(e){r.setIsTemplate(!0),e.store()})),n.add('delete-template',(function(e){r.delete(t.onDelete,t.onDeleteError)}))},U=n(7),V=n.n(U),F='indexeddb',q='rest-api',H='firestore';function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var G=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.StorageManager,i=F,o=n.objectStoreName,a=function(){return t},s=function(e){if(t)e(t);else{var a=(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB).open(n.dbName,n.indexeddbVersion),s=function(){return r.onError(i,a.errorCode)};a.onerror=s,a.onsuccess=function(){(t=a.result).onerror=s,e(t)},a.onupgradeneeded=function(e){e.currentTarget.result.createObjectStore(o,{keyPath:'id'}).createIndex('name','name',{unique:!1})}}},c=function(){return t.transaction([o],'readwrite').objectStore(o)},u=function(e){t?e(c()):s((function(t){return e(c())}))};r.add(i,{currentName:'Default',currentId:'uuidv4',currentThumbnail:'',isTemplate:!1,description:'No description',getDb:a,getObjectStore:c,setId:function(e){this.currentId=e},setName:function(e){this.currentName=e},setThumbnail:function(e){this.currentThumbnail=e},setIsTemplate:function(e){this.isTemplate=!!e},setDescription:function(e){this.description=e},load:function(e,t,n){var r=this;u((function(e){var i=e.get(r.currentId);i.onerror=n,i.onsuccess=function(){t&&t(i.result)}}))},loadAll:function(e,t){u((function(n){var r=n.getAll();r.onerror=t,r.onsuccess=function(){e&&e(r.result)}}))},store:function(e,t,n){var r=this;u((function(i){var o=i.put(z({id:r.currentId,name:r.currentName,template:r.isTemplate,thumbnail:r.currentThumbnail,description:r.description,updated_at:Date()},e));o.onerror=n,o.onsuccess=t}))},update:function(e,t,n){var r=e.id,i=V()(e,["id"]);u((function(e){var o=e.get(r);o.onerror=n,o.onsuccess=function(){e.put(z(z({id:r},o.result),i)),t&&t(o.result)}}))},delete:function(e,t,n){var r=this;u((function(i){var o=i.delete(n||r.currentId);o.onerror=t,o.onsuccess=e}))}})};function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var K=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.StorageManager,r=q,i=n.get('remote');n.add(r,{currentName:'Default',currentId:'uuidv4',currentThumbnail:'',isTemplate:!1,description:'No description',setId:function(e){this.currentId=e},setName:function(e){this.currentName=e},setThumbnail:function(e){this.currentThumbnail=e},setIsTemplate:function(e){this.isTemplate=!!e},setDescription:function(e){this.description=e},load:function(e,t,n){var r=i.get('urlLoad'),o=r.endsWith("/")?this.currentId:"/".concat(this.currentId);i.set({urlLoad:r+o}),i.load(e,t,n),i.set({urlLoad:r})},loadAll:function(e,t){i.load({},e,t)},store:function(e,n,r){var o=i.get('urlStore'),a=o.endsWith("/")?this.currentId:"/".concat(this.currentId);t.uuidInPath&&i.set({urlStore:o+a}),i.store(J({id:this.currentId,name:this.currentName,template:this.isTemplate,thumbnail:this.currentThumbnail,description:this.description,updated_at:Date()},e),n,r),i.set({urlStore:o})},update:function(e,t,n){var r=i.get('urlLoad'),o=e.id;o=r.endsWith("/")?o:"/".concat(o),i.set({urlLoad:r+o}),i.load({},(function(r){var a=J(J({},r),e),s=i.get('urlStore');o=s.endsWith("/")?o:"/".concat(o),i.request(s+o,{method:'post',body:a},t,n)}),n),i.set({urlLoad:r})},delete:function(e,t,n){var r=i.get('urlDelete'),o=n||this.currentId;o=r.endsWith("/")?o:"/".concat(o);i.request(r+o,{method:'delete'},e,t)}})};function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Z=function(e){var t,n,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=e.StorageManager,a=H,s=i.apiKey,c=i.authDomain,u=i.projectId,l=i.settings,d=function(){return n},f=function(e){if(r)return e(r);firebase.apps.length?(firebase.app(),(t=firebase.firestore()).settings(l)):(firebase.initializeApp(Q({apiKey:s,authDomain:c,projectId:u},i.firebaseConfig)),(t=firebase.firestore()).settings(l));r=t.collection(i.objectStoreName),e(r)},p=function(t){f((function(r){var i=e.Storage.getCurrentStorage();n=r.doc(i.currentId),t(n)}))};o.add(a,{currentName:'Default',currentId:'uuidv4',currentThumbnail:'',isTemplate:!1,description:'No description',getDoc:d,setDocId:function(e){this.currentId=e},setId:function(e){this.currentId=e},setName:function(e){this.currentName=e},setThumbnail:function(e){this.currentThumbnail=e},setIsTemplate:function(e){this.isTemplate=!!e},setDescription:function(e){this.description=e},load:function(e,t,n){p((function(e){e.get().then((function(e){return e.exists&&t(e.data())})).catch(n)}))},loadAll:function(e,t){f((function(n){n.get().then((function(t){var n=[];t.forEach((function(e){return n.push(e.data())})),e(n)})).catch(t)}))},store:function(e,t,n){var r=this;f((function(i){i.doc(e.idx||r.currentIdx).set(Q({id:r.currentId,name:r.currentName,template:r.isTemplate,thumbnail:r.currentThumbnail,description:r.description,updated_at:Date()},e)).then(t).catch(n)}))},update:function(e,t,n){var r=e.id,i=V()(e,["id"]);f((function(e){e.doc(r).set(i,{merge:!0}).then(t).catch(n)}))},delete:function(e,t,n){n?f((function(r){r.doc(n).delete().then(e).catch(t)})):p((function(n){n.delete().then(e).catch(t)}))}})},ee=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};G(e,t),K(e,t),Z(e,t)};function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t["default"]=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=ne(ne({},{dbName:'gjs',objectStoreName:'projects',loadFirst:!0,uuidInPath:!0,indexeddbVersion:5,onDelete:function(e){console.log('Deleted:',e)},onDeleteError:function(e){console.log(e)},onScreenshotError:function(e){console.log(e)},quality:.01,mdlTitle:'Project Manager',tabsText:{pages:'All',templates:'Templates'},help:'Select a template, enter project name, then click create. If no template is selected a blank project will be created.',nopages:'<div style="display:flex;align-items:center;padding:50px;margin:auto;">No Projects Yet</div>',apiKey:'',authDomain:'',projectId:'',enableOffline:!0,firebaseConfig:{},settings:{timestampsInSnapshots:!0}}),t);e.TemplateManager=new M(e,n),e.PagesApp=new _(e,n),e.SettingsApp=new C(e,n),B(e,n),ee(e,n),e.on('load',(function(){var t=e.Storage.getCurrentStorage();t.loadAll((function(r){var i=r[0];i&&n.loadFirst?(t.setId(i.id),t.setName(i.name),t.setThumbnail(i.thumbnail),t.setIsTemplate(i.template),e.load()):(t.setId(e.runCommand('get-uuidv4')),t.setName("Default-".concat(t.currentId.substr(0,7))),n.components&&e.setComponents(n.components),n.style&&e.setStyle(n.style))}))}))}}])}));
//# sourceMappingURL=grapesjs-project-manager.min.js.map